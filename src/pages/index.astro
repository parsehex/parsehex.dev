---
import Hero from '@/components/common/Hero.astro';
import BaseLayout from "@/layouts/BaseLayout.astro";
import ContentMasonry from "@/components/common/ContentMasonry.astro";
import { getContentItems } from "@/utils/content-utils";
import { collections } from "@/content.config";

// Dynamically fetch content groups
const previewCount = 6;
const collectionKeys = Object.keys(collections);

const groups = await Promise.all(
  collectionKeys.map(async (key) => {
    const items = await getContentItems(key as any);
    const title = key.charAt(0).toUpperCase() + key.slice(1);

    return {
      title,
      count: items.length,
      viewAllLink: `/${key}`,
      items: items.slice(0, previewCount),
      type: key
    };
  })
);

// Filter out empty groups if desired
const nonEmptyGroups = groups.filter(g => g.count > 0);
---

<BaseLayout
  pageTitle="parsehex.dev"
  pageDescription="Trying to define what's meaningful to me"
>
  <Hero
		subtitle="Trying to define what's meaningful to me"
		size="is-small"
    primary
	/>

  <section class="section">
    <div class="container">
      <ContentMasonry groups={nonEmptyGroups} />
    </div>
  </section>
</BaseLayout>
